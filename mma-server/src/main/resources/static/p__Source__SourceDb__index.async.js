"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[18],{71886:function(lt,pe,r){r.d(pe,{J:function(){return Ue}});var _e=r(29883),U=r.n(_e),ze=r(37306),me=r.n(ze),se=r(66933),fe=r.n(se),J=r(94043),he=r.n(J),Ee=r(61122),K=r(5966),Q=r(64317),Ye=r(93083),Ne=r(86615),qe=r(97462),_=r(90672),ne=r(52688),Ke=r(31768),X=r(24739),re=r(62435),ye=r(51198),x=r(48086),t=r(5251),a=r(86074),Ue=function(C){var H,Te=(0,re.useState)(),ue=fe()(Te,2),B=ue[0],I=ue[1],Y=(0,re.useState)(!1),q=fe()(Y,2),Ve=q[0],je=q[1],we={},We=(0,re.useState)(we),Se=fe()(We,2),G=Se[0],oe=Se[1],De=(0,re.useRef)(),Ie=(0,re.useRef)(null);(0,re.useEffect)(function(){var V,w,$;if(C.db!=null){var S=C.db;(0,ye.S5)(S.sourceName,S.name).then(function(z){I(z.data),G!==void 0&&(G.task_type=z.data.defaultTaskType)}),G.source_name=(V=C.db)===null||V===void 0?void 0:V.sourceName,G.db_name=(w=C.db)===null||w===void 0?void 0:w.name,(C==null?void 0:C.tables)!==void 0&&(G.tables=C==null?void 0:C.tables),C.jobType=="database"&&(G.description=S.name),oe(G),($=De.current)===null||$===void 0||$.resetFields()}},[C.db,C.tables,C.visible]);var be={},le=me()((B==null?void 0:B.tables)||[]),Pe;try{for(le.s();!(Pe=le.n()).done;){var Ce=Pe.value;be[Ce]=Ce}}catch(V){le.e(V)}finally{le.f()}var de=[{required:!1,warningOnly:!0,pattern:/^((\w+)\s*,\s*)*(\w+)$/,message:"\u591A\u4E2A\u8868\u540D\u4E4B\u95F4\u4EE5\u9017\u53F7(,)\u5206\u5272"}];return(H=Ie.current)===null||H===void 0||H.focus(),(0,a.jsx)(Ee.Y,{title:"\u65B0\u5EFA\u8FC1\u79FB\u4EFB\u52A1",visible:C.visible,onVisibleChange:C.setVisible,layout:"horizontal",grid:!0,labelCol:{span:3},labelAlign:"left",formRef:De,onFinish:function(){var V=U()(he().mark(function w($){var S,z,k,W,ie,ce,ee,ve,Fe;return he().wrap(function(Be){for(;;)switch(Be.prev=Be.next){case 0:S={},Object.assign(S,$),delete S.enable_config,z="partition_filters",z in S&&(k=xe(S[z],"srcTable","partitionFilter"),Object.keys(k).length>0?S[z]=k:delete S[z]),W="table_mapping",W in S&&(ie=xe(S[W],"srcTable","dstTable"),Object.keys(ie).length>0?S[W]=ie:delete S[W]),ce="table_whitelist",ee="table_blacklist",ce in S&&(S[ce]=S[ce].trim().split(/\s*,\s*/)),ee in S&&(S[ee]=S[ee].trim().split(/\s*,\s*/)),ve="tables",ve in S&&(S[ve]=S[ve].trim().split(/\s*,\s*/)),S.type=C.jobType,oe(S),Fe=x.ZP.loading("\u63D0\u4EA4\u8FC1\u79FB\u4EFB\u52A1\u4E2D..."),(0,ye.p1)(S).then(function(te){if(te.success){C.setVisible(!1);return}(0,t.oc)(te)}).catch(function(te){var ge=te.response.data;x.ZP.error(ge.message,10)}).finally(function(){Fe()});case 17:case"end":return Be.stop()}},w)}));return function(w){return V.apply(this,arguments)}}(),children:function(){if(!Ve){var V,w,$;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(K.Z,{name:"description",label:"\u540D\u79F0:",placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",initialValue:"".concat((V=C.db)===null||V===void 0?void 0:V.name,"@").concat((0,t.je)()),rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0"}],fieldProps:{ref:Ie}}),(0,a.jsx)(K.Z,{name:"source_name",label:"\u6570\u636E\u6E90:",placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",initialValue:(w=C.db)===null||w===void 0?void 0:w.sourceName,disabled:!0}),(0,a.jsx)(K.Z,{name:"db_name",label:"\u5E93\u540D:",placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",initialValue:($=C.db)===null||$===void 0?void 0:$.name,disabled:!0}),(0,a.jsx)(Q.Z,{colProps:{span:24},label:"\u4EFB\u52A1\u7C7B\u578B:",name:"task_type",initialValue:B==null?void 0:B.defaultTaskType,valueEnum:B==null?void 0:B.taskTypes,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4EFB\u52A1\u7C7B\u578B"}]}),(0,a.jsx)(Q.Z,{colProps:{span:24},label:"mc\u9879\u76EE:",name:"dst_mc_project",valueEnum:function(){var S={},z=me()((B==null?void 0:B.dstMcProjects)||[]),k;try{for(z.s();!(k=z.n()).done;){var W=k.value;S[W]=W}}catch(ie){z.e(ie)}finally{z.f()}return S}(),rules:[{required:!0,message:"\u8BF7\u9009\u62E9mc\u9879\u76EE"}]}),function(){if(C.jobType==="database")return(0,a.jsxs)(Ye.A.Group,{children:[(0,a.jsx)(Ne.Z.Group,{name:"whiteOrBlackList",colProps:{offset:3},initialValue:"tableWhiteList",options:[{label:"table\u767D\u540D\u5355",value:"tableWhiteList"},{value:"tableBlackList",label:"table\u9ED1\u540D\u5355"}]}),(0,a.jsx)(qe.Z,{name:["whiteOrBlackList"],children:function(k){var W=k.whiteOrBlackList;return W==="tableBlackList"?(0,a.jsx)(_.Z,{name:"table_blacklist",label:"table\u9ED1\u540D\u5355",rules:de}):(0,a.jsx)(_.Z,{name:"table_whitelist",label:"table\u767D\u540D\u5355",rules:de})}})]});if(C.jobType=="tables"){var S;return(0,a.jsx)(_.Z,{name:"tables",label:"table\u5217\u8868",rules:de,initialValue:C==null||(S=C.tables)===null||S===void 0?void 0:S.join(",")})}}(),(0,a.jsx)(ne.Z,{colProps:{span:24},initialValue:!0,label:"\u5F00\u542F\u6821\u9A8C",name:"enable_verification"}),(0,a.jsx)(ne.Z,{colProps:{span:24},initialValue:!0,label:"\u589E\u91CF\u66F4\u65B0",name:"increment"}),(0,a.jsx)(ne.Z,{colProps:{span:24},initialValue:!1,label:"\u53EA\u8FC1schema",name:"schema_only"}),(0,a.jsx)(Ke.u,{name:"partition_filters",label:"\u5206\u533A\u8FC7\u6EE4",children:(0,a.jsxs)(X.UW,{children:[(0,a.jsx)(Q.Z,{showSearch:!0,name:"srcTable",valueEnum:be,colProps:{span:10},placeholder:"\u8BF7\u8F93\u5165\u6E90\u8868"}),(0,a.jsx)(K.Z,{name:"partitionFilter",placeholder:"p1 > '2022-08-20' and p2 > 10",colProps:{span:10}})]},"group")}),(0,a.jsx)(Ke.u,{name:"table_mapping",label:"\u8868\u540D\u6620\u5C04",children:(0,a.jsxs)(X.UW,{children:[(0,a.jsx)(Q.Z,{showSearch:!0,name:"srcTable",valueEnum:be,colProps:{span:10},placeholder:"\u8BF7\u8F93\u5165\u6E90\u8868"}),(0,a.jsx)(K.Z,{name:"dstTable",colProps:{span:10},placeholder:"\u8BF7\u8F93\u5165\u76EE\u7684\u8868"})]},"group")})]})}return(0,a.jsx)(_.Z,{name:"jsonConfig",label:"\u914D\u7F6E\u6587\u4EF6",initialValue:JSON.stringify(G,null,4)})}()})};function xe(Ze,C,H){var Te=Ze.filter(function(q){return C in q&&H in q}),ue={},B=me()(Te),I;try{for(B.s();!(I=B.n()).done;){var Y=I.value;ue[Y[C]]=Y[H]}}catch(q){B.e(q)}finally{B.f()}return ue}},14381:function(lt,pe,r){r.r(pe),r.d(pe,{default:function(){return Ot}});var _e=r(66933),U=r.n(_e),ze=r(85067),me=r(29883),se=r.n(me),fe=r(94043),J=r.n(fe),he=r(15999),Ee=r(93433),K=r(74165),Q=r(15861),Ye=r(16286),Ne=r(91256),qe=r(43146),_=r(4914),ne=r(44925),Ke=r(9463),X=r(19650),re=r(61814),ye=r(86835),x=r(1413),t=r(62435),a=r(86074),Ue=r(54549),xe=r(79508),Ze=r(8212),C=r(50026),H=r(86095),Te=r(78692),ue=r(3700),B=r(91894),I=r(90860),Y=r(38069),q=r(26390),Ve=r(27049),je=function(e){var n=e.padding;return t.createElement("div",{style:{padding:n||"0 24px"}},t.createElement(Ve.Z,{style:{margin:0}}))},we={xs:2,sm:2,md:4,lg:4,xl:6,xxl:6},We=function(e){var n=e.size,s=e.active,i=(0,Y.ZP)(),h=n===void 0?we[i]||6:n,E=function(d){return d===0?0:h>2?42:16};return t.createElement(B.Z,{bordered:!1,style:{marginBottom:16}},t.createElement("div",{style:{width:"100%",justifyContent:"space-between",display:"flex"}},new Array(h).fill(null).map(function(l,d){return t.createElement("div",{key:d,style:{borderLeft:h>2&&d===1?"1px solid rgba(0,0,0,0.06)":void 0,paddingLeft:E(d),flex:1,marginRight:d===0?16:0}},t.createElement(I.Z,{active:s,paragraph:!1,title:{width:100,style:{marginTop:0}}}),t.createElement(I.Z.Button,{active:s,style:{height:48}}))})))},Se=function(e){var n=e.active;return t.createElement(t.Fragment,null,t.createElement(B.Z,{bordered:!1,style:{borderRadius:0},bodyStyle:{padding:24}},t.createElement("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"}},t.createElement("div",{style:{maxWidth:"100%",flex:1}},t.createElement(I.Z,{active:n,title:{width:100,style:{marginTop:0}},paragraph:{rows:1,style:{margin:0}}})),t.createElement(I.Z.Button,{active:n,size:"small",style:{width:165,marginTop:12}}))),t.createElement(je,null))},G=function(e){var n=e.size,s=e.active,i=s===void 0?!0:s,h=e.actionButton;return t.createElement(B.Z,{bordered:!1,bodyStyle:{padding:0}},new Array(n).fill(null).map(function(E,l){return t.createElement(Se,{key:l,active:!!i})}),h!==!1&&t.createElement(B.Z,{bordered:!1,style:{borderTopRightRadius:0,borderTopLeftRadius:0},bodyStyle:{display:"flex",alignItems:"center",justifyContent:"center"}},t.createElement(I.Z.Button,{style:{width:102},active:i,size:"small"})))},oe=function(e){var n=e.active;return t.createElement("div",{style:{marginBottom:16}},t.createElement(I.Z,{paragraph:!1,title:{width:185}}),t.createElement(I.Z.Button,{active:n,size:"small"}))},De=function(e){var n=e.active;return t.createElement(B.Z,{bordered:!1,style:{borderBottomRightRadius:0,borderBottomLeftRadius:0},bodyStyle:{paddingBottom:8}},t.createElement(X.Z,{style:{width:"100%",justifyContent:"space-between"}},t.createElement(I.Z.Button,{active:n,style:{width:200},size:"small"}),t.createElement(X.Z,null,t.createElement(I.Z.Button,{active:n,size:"small",style:{width:120}}),t.createElement(I.Z.Button,{active:n,size:"small",style:{width:80}}))))},Ie=function(e){var n=e.active,s=n===void 0?!0:n,i=e.statistic,h=e.actionButton,E=e.toolbar,l=e.pageHeader,d=e.list,P=d===void 0?5:d;return t.createElement("div",{style:{width:"100%"}},l!==!1&&t.createElement(oe,{active:s}),i!==!1&&t.createElement(We,{size:i,active:s}),(E!==!1||P!==!1)&&t.createElement(B.Z,{bordered:!1,bodyStyle:{padding:0}},E!==!1&&t.createElement(De,{active:s}),P!==!1&&t.createElement(G,{size:P,active:s,actionButton:h})))},be=Ie,le={xs:1,sm:2,md:3,lg:3,xl:3,xxl:4},Pe=function(e){var n=e.active;return t.createElement("div",{style:{marginTop:32}},t.createElement(I.Z.Button,{active:n,size:"small",style:{width:100,marginBottom:16}}),t.createElement("div",{style:{width:"100%",justifyContent:"space-between",display:"flex"}},t.createElement("div",{style:{flex:1,marginRight:24,maxWidth:300}},t.createElement(I.Z,{active:n,paragraph:!1,title:{style:{marginTop:0}}}),t.createElement(I.Z,{active:n,paragraph:!1,title:{style:{marginTop:8}}}),t.createElement(I.Z,{active:n,paragraph:!1,title:{style:{marginTop:8}}})),t.createElement("div",{style:{flex:1,alignItems:"center",justifyContent:"center"}},t.createElement("div",{style:{maxWidth:300,margin:"auto"}},t.createElement(I.Z,{active:n,paragraph:!1,title:{style:{marginTop:0}}}),t.createElement(I.Z,{active:n,paragraph:!1,title:{style:{marginTop:8}}})))))},Ce=function(e){var n=e.size,s=e.active,i=(0,Y.ZP)(),h=n===void 0?le[i]||3:n;return t.createElement("div",{style:{width:"100%",justifyContent:"space-between",display:"flex"}},new Array(h).fill(null).map(function(E,l){return t.createElement("div",{key:l,style:{flex:1,paddingLeft:l===0?0:24,paddingRight:l===h-1?0:24}},t.createElement(I.Z,{active:s,paragraph:!1,title:{style:{marginTop:0}}}),t.createElement(I.Z,{active:s,paragraph:!1,title:{style:{marginTop:8}}}),t.createElement(I.Z,{active:s,paragraph:!1,title:{style:{marginTop:8}}}))}))},de=function(e){var n=e.active,s=e.header,i=s===void 0?!1:s,h=(0,Y.ZP)(),E=le[h]||3;return t.createElement(t.Fragment,null,t.createElement("div",{style:{display:"flex",background:i?"rgba(0,0,0,0.02)":"none",padding:"24px 8px"}},new Array(E).fill(null).map(function(l,d){return t.createElement("div",{key:d,style:{flex:1,paddingLeft:i&&d===0?0:20,paddingRight:32}},t.createElement(I.Z,{active:n,paragraph:!1,title:{style:{margin:0,height:24,width:i?"75px":"100%"}}}))}),t.createElement("div",{style:{flex:3,paddingLeft:32}},t.createElement(I.Z,{active:n,paragraph:!1,title:{style:{margin:0,height:24,width:i?"75px":"100%"}}}))),t.createElement(je,{padding:"0px 0px"}))},V=function(e){var n=e.active,s=e.size,i=s===void 0?4:s;return t.createElement(B.Z,{bordered:!1},t.createElement(I.Z.Button,{active:n,size:"small",style:{width:100,marginBottom:16}}),t.createElement(de,{header:!0,active:n}),new Array(i).fill(null).map(function(h,E){return t.createElement(de,{key:E,active:n})}),t.createElement("div",{style:{display:"flex",justifyContent:"flex-end",paddingTop:16}},t.createElement(I.Z,{active:n,paragraph:!1,title:{style:{margin:0,height:32,float:"right",maxWidth:"630px"}}})))},w=function(e){var n=e.active;return t.createElement(B.Z,{bordered:!1,style:{borderTopRightRadius:0,borderTopLeftRadius:0}},t.createElement(I.Z.Button,{active:n,size:"small",style:{width:100,marginBottom:16}}),t.createElement(Ce,{active:n}),t.createElement(Pe,{active:n}))},$=function(e){var n=e.active,s=n===void 0?!0:n,i=e.pageHeader,h=e.list;return t.createElement("div",{style:{width:"100%"}},i!==!1&&t.createElement(oe,{active:s}),t.createElement(w,{active:s}),h!==!1&&t.createElement(je,null),h!==!1&&t.createElement(V,{active:s,size:h}))},S=$,z=function(e){var n=e.active,s=n===void 0?!0:n,i=e.pageHeader;return t.createElement("div",{style:{width:"100%"}},i!==!1&&t.createElement(oe,{active:s}),t.createElement(B.Z,null,t.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",padding:128}},t.createElement(I.Z.Avatar,{size:64,style:{marginBottom:32}}),t.createElement(I.Z.Button,{active:s,style:{width:214,marginBottom:8}}),t.createElement(I.Z.Button,{active:s,style:{width:328},size:"small"}),t.createElement(X.Z,{style:{marginTop:24}},t.createElement(I.Z.Button,{active:s,style:{width:116}}),t.createElement(I.Z.Button,{active:s,style:{width:116}})))))},k=z,W=["type"],ie=function(e){var n=e.type,s=n===void 0?"list":n,i=(0,ne.Z)(e,W);return s==="result"?t.createElement(k,i):s==="descriptions"?t.createElement(S,i):t.createElement(be,i)},ce=ie,ee=r(2026),ve=r(58261),Fe=r(5197),$e=r(67552),Be=r(61475),te=r(48086),ge=r(29439),it=r(78775),Je=r(21770),Re=r(34732);function st(o){var e=o.data,n=o.row;return(0,x.Z)((0,x.Z)({},e),n)}function ut(o){var e=o.type||"single",n=(0,Je.Z)([],{value:o.editableKeys,onChange:o.onChange?function(p){var y;o==null||(y=o.onChange)===null||y===void 0||y.call(o,p,o.dataSource)}:void 0}),s=(0,ge.Z)(n,2),i=s[0],h=s[1],E=(0,t.useMemo)(function(){var p=e==="single"?i==null?void 0:i.slice(0,1):i;return new Set(p)},[(i||[]).join(","),e]),l=(0,t.useCallback)(function(p){return!!(i!=null&&i.includes((0,Re.sN)(p)))},[(i||[]).join(",")]),d=function(y){return E.size>0&&e==="single"?(te.ZP.warn(o.onlyOneLineEditorAlertMessage||"\u53EA\u80FD\u540C\u65F6\u7F16\u8F91\u4E00\u884C"),!1):(E.add((0,Re.sN)(y)),h(Array.from(E)),!0)},P=function(y){return E.delete((0,Re.sN)(y)),h(Array.from(E)),!0},L=function(){var p=(0,Q.Z)((0,K.Z)().mark(function y(b,D,c,Z){var g,u;return(0,K.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,o==null||(g=o.onCancel)===null||g===void 0?void 0:g.call(o,b,D,c,Z);case 2:if(u=v.sent,u!==!1){v.next=5;break}return v.abrupt("return",!1);case 5:return v.abrupt("return",!0);case 6:case"end":return v.stop()}},y)}));return function(b,D,c,Z){return p.apply(this,arguments)}}(),A=function(){var p=(0,Q.Z)((0,K.Z)().mark(function y(b,D,c){var Z,g,u;return(0,K.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,o==null||(Z=o.onSave)===null||Z===void 0?void 0:Z.call(o,b,D,c);case 2:if(g=v.sent,g!==!1){v.next=5;break}return v.abrupt("return",!1);case 5:return P(b),u={data:o.dataSource,row:D,key:b,childrenColumnName:o.childrenColumnName||"children"},o.setDataSource(st(u)),v.abrupt("return",!0);case 9:case"end":return v.stop()}},y)}));return function(b,D,c){return p.apply(this,arguments)}}(),R=(0,it.YB)(),O=R.getMessage("editableTable.action.save","\u4FDD\u5B58"),T=R.getMessage("editableTable.action.delete","\u5220\u9664"),m=R.getMessage("editableTable.action.cancel","\u53D6\u6D88"),f=(0,t.useCallback)(function(p,y,b){var D=(0,x.Z)({recordKey:p,cancelEditable:P,onCancel:L,onSave:A,editableKeys:i,setEditableRowKeys:h,form:y,saveText:O,cancelText:m,deleteText:T,deletePopconfirmMessage:"\u5220\u9664\u6B64\u884C\uFF1F",editorType:"Map"},b),c=(0,Re.aX)(o.dataSource,D);return o.actionRender?o.actionRender(o.dataSource,D,{save:c[0],delete:c[1],cancel:c[2]}):c},[i&&i.join(","),o.dataSource]);return{editableKeys:i,setEditableRowKeys:h,isEditable:l,actionRender:f,startEditable:d,cancelEditable:P}}var ot=ut,dt=r(78164),ct=r(50344),vt=r(88306),mt=r(30939),ft=function(e,n){var s=n||{},i=s.onRequestError,h=s.effects,E=s.manual,l=s.dataSource,d=s.defaultDataSource,P=s.onDataSourceChange,L=(0,Je.Z)(d,{value:l,onChange:P}),A=(0,ge.Z)(L,2),R=A[0],O=A[1],T=(0,Je.Z)(n==null?void 0:n.loading,{value:n==null?void 0:n.loading,onChange:n==null?void 0:n.onLoadingChange}),m=(0,ge.Z)(T,2),f=m[0],p=m[1],y=function(c){O(c),p(!1)},b=function(){var D=(0,Q.Z)((0,K.Z)().mark(function c(){var Z,g,u;return(0,K.Z)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!f){v.next=2;break}return v.abrupt("return");case 2:return p(!0),v.prev=3,v.next=6,e();case 6:if(v.t0=v.sent,v.t0){v.next=9;break}v.t0={};case 9:Z=v.t0,g=Z.data,u=Z.success,u!==!1&&y(g),v.next=23;break;case 15:if(v.prev=15,v.t1=v.catch(3),i!==void 0){v.next=21;break}throw new Error(v.t1);case 21:i(v.t1);case 22:p(!1);case 23:case"end":return v.stop()}},c,null,[[3,15]])}));return function(){return D.apply(this,arguments)}}();return(0,t.useEffect)(function(){E||b()},[].concat((0,Ee.Z)(h||[]),[E])),{dataSource:R,setDataSource:O,loading:f,reload:function(){return b()}}},ht=ft,Et=["valueEnum","render","renderText","mode","plain","dataIndex","request","params","editable"],bt=["request","columns","params","dataSource","onDataSourceChange","formProps","editable","loading","onLoadingChange","actionRef","onRequestError"],gt=function(e,n){var s=e.dataIndex;if(s){var i=Array.isArray(s)?(0,vt.Z)(n,s):n[s];if(i!==void 0||i!==null)return i}return e.children},pt=function(e){var n=e.valueEnum,s=e.action,i=e.index,h=e.text,E=e.entity,l=e.mode,d=e.render,P=e.editableUtils,L=e.valueType,A=e.plain,R=e.dataIndex,O=e.request,T=e.renderFormItem,m=e.params,f={text:h,valueEnum:n,mode:l||"read",proFieldProps:{render:d?function(){return d==null?void 0:d(h,E,i,s,(0,x.Z)((0,x.Z)({},e),{},{type:"descriptions"}))}:void 0},ignoreFormItem:!0,valueType:L,request:O,params:m,plain:A};if(l==="read"||!l||L==="option"){var p=(0,ee.Z)(e.fieldProps,void 0,(0,x.Z)((0,x.Z)({},e),{},{rowKey:R,isEditable:!1}));return(0,a.jsx)(H.Z,(0,x.Z)((0,x.Z)({name:R},f),{},{fieldProps:p}))}return(0,a.jsx)("div",{style:{marginTop:-5,marginBottom:-5,marginLeft:0,marginRight:0},children:(0,a.jsx)(ye.Z.Item,{noStyle:!0,shouldUpdate:function(b,D){return b!==D},children:function(b){var D,c=(0,ee.Z)(e.formItemProps,b,(0,x.Z)((0,x.Z)({},e),{},{rowKey:R,isEditable:!0})),Z=(0,ee.Z)(e.fieldProps,b,(0,x.Z)((0,x.Z)({},e),{},{rowKey:R,isEditable:!0})),g=T?T==null?void 0:T((0,x.Z)((0,x.Z)({},e),{},{type:"descriptions"}),{isEditable:!0,recordKey:R,record:b.getFieldValue([R].flat(1)),defaultRender:function(){return(0,a.jsx)(H.Z,(0,x.Z)((0,x.Z)({},f),{},{fieldProps:Z}))},type:"descriptions"},b):void 0;return(0,a.jsxs)(X.Z,{children:[(0,a.jsx)(ve.Z,(0,x.Z)((0,x.Z)({name:R},c),{},{style:(0,x.Z)({margin:0},(c==null?void 0:c.style)||{}),initialValue:h||(c==null?void 0:c.initialValue),children:g||(0,a.jsx)(H.Z,(0,x.Z)((0,x.Z)({},f),{},{proFieldProps:(0,x.Z)({},f.proFieldProps),fieldProps:Z}))})),P==null||(D=P.actionRender)===null||D===void 0?void 0:D.call(P,R||i,b,{cancelText:(0,a.jsx)(Ue.Z,{}),saveText:(0,a.jsx)(xe.Z,{}),deleteText:!1})]})}})})},yt=function(e,n,s,i){var h,E=[],l=e==null||(h=e.map)===null||h===void 0?void 0:h.call(e,function(d,P){var L,A;if(t.isValidElement(d))return d;var R=d.valueEnum,O=d.render,T=d.renderText,m=d.mode,f=d.plain,p=d.dataIndex,y=d.request,b=d.params,D=d.editable,c=(0,ne.Z)(d,Et),Z=(L=gt(d,n))!==null&&L!==void 0?L:c.children,g=T?T(Z,n,P,s):Z,u=typeof c.title=="function"?c.title(d,"descriptions",null):c.title,M=typeof c.valueType=="function"?c.valueType(n||{},"descriptions"):c.valueType,v=i==null?void 0:i.isEditable(p||P),N=m||v?"edit":"read",j=i&&N==="read"&&D!==!1&&(D==null?void 0:D(g,n,P))!==!1,F=j?X.Z:t.Fragment,Xe=N==="edit"?g:(0,Fe.X)(g,d,g),Me=(0,t.createElement)(_.Z.Item,(0,x.Z)((0,x.Z)({},c),{},{key:c.key||((A=c.label)===null||A===void 0?void 0:A.toString())||P,label:(u||c.label||c.tooltip||c.tip)&&(0,a.jsx)($e.Z,{label:u||c.label,tooltip:c.tooltip||c.tip,ellipsis:d.ellipsis})}),(0,a.jsxs)(F,{children:[(0,a.jsx)(pt,(0,x.Z)((0,x.Z)({},d),{},{dataIndex:d.dataIndex||P,mode:N,text:Xe,valueType:M,entity:n,index:P,action:s,editableUtils:i})),j&&M!=="option"&&(0,a.jsx)(Ze.Z,{onClick:function(){i==null||i.startEditable(p||P)}})]}));return M==="option"?(E.push(Me),null):Me}).filter(function(d){return d});return{options:E!=null&&E.length?E:null,children:l}},xt=function(e){return(0,a.jsx)(_.Z.Item,(0,x.Z)((0,x.Z)({},e),{},{children:e.children}))},Zt=function(e){return e.children},et=function(e){var n,s=e.request,i=e.columns,h=e.params,E=h===void 0?{}:h,l=e.dataSource,d=e.onDataSourceChange,P=e.formProps,L=e.editable,A=e.loading,R=e.onLoadingChange,O=e.actionRef,T=e.onRequestError,m=(0,ne.Z)(e,bt),f=(0,t.useContext)(Ne.ZP.ConfigContext),p=ht((0,Q.Z)((0,K.Z)().mark(function v(){var N;return(0,K.Z)().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(!s){F.next=6;break}return F.next=3,s(E);case 3:F.t0=F.sent,F.next=7;break;case 6:F.t0={data:{}};case 7:return N=F.t0,F.abrupt("return",N);case 9:case"end":return F.stop()}},v)})),{onRequestError:T,effects:[(0,mt.P)(E)],manual:!s,dataSource:l,loading:A,onLoadingChange:R,onDataSourceChange:d}),y=ot((0,x.Z)((0,x.Z)({},e.editable),{},{childrenColumnName:void 0,dataSource:p.dataSource,setDataSource:p.setDataSource}));if((0,t.useEffect)(function(){O&&(O.current=(0,x.Z)({reload:p.reload},y))},[p,O,y]),p.loading||p.loading===void 0&&s)return(0,a.jsx)(ce,{type:"descriptions",list:!1,pageHeader:!1});var b=function(){var N=(0,ct.Z)(e.children).filter(Boolean).map(function(j){if(!t.isValidElement(j))return j;var F=j==null?void 0:j.props,Xe=F.valueEnum,Me=F.valueType,rt=F.dataIndex,Mt=F.ellipsis,_t=F.copyable,zt=F.request;return!Me&&!Xe&&!rt&&!zt&&!Mt&&!_t?j:(0,x.Z)((0,x.Z)({},j==null?void 0:j.props),{},{entity:l})});return[].concat((0,Ee.Z)(i||[]),(0,Ee.Z)(N)).filter(function(j){return!j||(j==null?void 0:j.valueType)&&["index","indexBorder"].includes(j==null?void 0:j.valueType)?!1:!(j!=null&&j.hideInDescriptions)}).sort(function(j,F){return F.order||j.order?(F.order||0)-(j.order||0):(F.index||0)-(j.index||0)})},D=yt(b(),p.dataSource||{},(O==null?void 0:O.current)||p,L?y:void 0),c=D.options,Z=D.children,g=L?C.ZP:Zt,u=null;(m.title||m.tooltip||m.tip)&&(u=(0,a.jsx)($e.Z,{label:m.title,tooltip:m.tooltip||m.tip}));var M=f.getPrefixCls("pro-descriptions");return(0,a.jsx)(dt.Z,{children:(0,a.jsx)(g,(0,x.Z)((0,x.Z)({form:(n=e.editable)===null||n===void 0?void 0:n.form,component:!1,submitter:!1},P),{},{onFinish:void 0,children:(0,a.jsx)(_.Z,(0,x.Z)((0,x.Z)({className:M},m),{},{extra:m.extra?(0,a.jsxs)(X.Z,{children:[c,m.extra]}):c,title:u,children:Z}))}),"form")})};et.Item=xt;var Nt=null,Le=r(5251),He=r(8836),tt={INIT:0,DOING:1,DONE:2,FAILED:3,PART_DONE:4},ae=r(15746),Tt=r(71230),Ae=r(54682),Ge=r(71577),jt=r(25084),St=r(71886),Dt=function(o){var e=(0,t.useState)(0),n=U()(e,2),s=n[0],i=n[1],h=(0,t.useState)(!1),E=U()(h,2),l=E[0],d=E[1],P=(0,t.useState)([]),L=U()(P,2),A=L[0],R=L[1],O=(0,t.useState)(!1),T=U()(O,2),m=T[0],f=T[1],p=(0,t.useState)(),y=U()(p,2),b=y[0],D=y[1],c=[{title:"\u8868\u540D",dataIndex:"name"},{title:"\u5206\u533A\u8868",dataIndex:"hasPartitions",render:function(g,u){return u.hasPartitions?"\u662F":"\u5426"},valueEnum:{no:{text:"\u975E\u5206\u533A\u8868"},yes:{text:"\u5206\u533A\u8868"}},valueType:"select",sorter:function(g,u){return(g.hasPartitions&&1)-(u.hasPartitions&&1)}},{title:"\u7C7B\u578B",dataIndex:"type",valueEnum:{MANAGED_TABLE:{text:"managed table"},VIRTUAL_VIEW:{text:"virtual view"},EXTERNAL_TABLE:{text:"external table"},MATERIALIZED_VIEW:{text:"materialized view"}},valueType:"select"},{title:"\u5206\u533A",dataIndex:"partitions",hideInSearch:!0,sorter:function(g,u){return g.partitions-u.partitions}},{title:"\u5B8C\u6210\u5206\u533A",dataIndex:"partitionsDone",hideInSearch:!0},{title:"\u6B63\u5728\u8FC1\u79FB\u5206\u533A",dataIndex:"partitionsDoing",hideInSearch:!0},{title:"\u5931\u8D25\u7684\u5206\u533A",dataIndex:"partitionsFailed",hideInSearch:!0},{title:"\u5927\u5C0F",dataIndex:"size",render:function(g,u){return u.size===void 0||u.size===0?"--":(0,Le.BU)(u.size)},search:!1,sorter:{compare:function(g,u){return g.size-u.size},multiple:2}},{title:"\u884C\u6570",dataIndex:"numRows",render:function(g,u){return u.numRows===void 0||u.numRows===0?"--":u.numRows},search:!1,sorter:{compare:function(g,u){return g.size-u.size},multiple:1}},{title:"\u6570\u636E\u6700\u540E\u4FEE\u6539\u65F6\u95F4",render:function(g,u){return u.lastDdlTime},dataIndex:"lastDdlTime",valueType:"dateRange",sorter:{compare:function(g,u){return 0},multiple:1}},{title:"\u72B6\u6001",dataIndex:"status",valueType:"checkbox",valueEnum:{INIT:{text:"\u672A\u8FC1\u79FB"},DONE:{text:"\u5B8C\u6210"},DOING:{text:"\u8FC1\u79FB\u4E2D"},FAILED:{text:"\u90E8\u5206\u5B8C\u6210\uFF0C\u6709\u5931\u8D25"},PART_DONE:{text:"\u90E8\u5206\u5B8C\u6210"}},sorter:function(g,u){return tt[g.status]-tt[u.status]}},{title:"schema",dataIndex:"name",render:function(g,u){if(u.schema==null)return"";var M=u.schema.columns.map(function(j){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ae.Z,{span:3,children:j.name}),(0,a.jsx)(ae.Z,{span:15,children:j.type}),(0,a.jsx)(ae.Z,{span:6,children:j.comment})]})}),v=u.schema.partitions.map(function(j){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ae.Z,{span:3,children:j.name}),(0,a.jsx)(ae.Z,{span:15,children:j.type}),(0,a.jsx)(ae.Z,{span:6,children:j.comment})]})}),N=v.length>0?(0,a.jsxs)(ae.Z,{span:24,children:[(0,a.jsx)("br",{}),"\u5206\u533A\u540D/\u7C7B\u578B"]}):"";return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(Tt.Z,{children:[(0,a.jsx)(ae.Z,{span:24,children:"\u5217\u540D/\u7C7B\u578B"}),M,N,v]})})},renderText:function(g,u,M,v){return JSON.stringify(u.schema,null,4)},hideInTable:!0,search:!1},{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",render:function(g,u){var M=[(0,a.jsx)("a",{onClick:function(){f(!0),D(u)},children:"\u8BE6\u60C5"},"1")];return M},search:!1}];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(he.Z,{columns:c,request:function(){var Z=se()(J().mark(function g(u,M,v){var N;return J().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return u.dbId=o.db.id,F.next=3,(0,He.Lk)(u,M,v);case 3:return N=F.sent,i((N==null?void 0:N.total)||0),F.abrupt("return",N);case 6:case"end":return F.stop()}},g)}));return function(g,u,M){return Z.apply(this,arguments)}}(),rowKey:"id",pagination:{showQuickJumper:!0,size:"default",responsive:!0,totalBoundaryShowSizeChanger:10,total:s},search:{filterType:"light"},rowSelection:{selections:[Ae.Z.SELECTION_ALL,Ae.Z.SELECTION_INVERT],onChange:function(g,u,M){R(u.map(function(v){return v.name}))}},toolbar:{actions:[(0,a.jsx)(Ge.Z,{type:"primary",onClick:function(){d(!0)},children:"\u65B0\u5EFA\u8FC1\u79FB\u4EFB\u52A1"},"key")]}}),(0,a.jsx)(jt.Z,{width:1e3,visible:m,onClose:function(){D(void 0),f(!1)},closable:!1,children:(0,a.jsx)(et,{column:2,title:b==null?void 0:b.name,bordered:!0,request:se()(J().mark(function Z(){return J().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",{data:b||{}});case 1:case"end":return u.stop()}},Z)})),params:{id:b==null?void 0:b.id},columns:c})}),(0,a.jsx)(St.J,{db:o.db,jobType:"tables",tables:A,visible:l,setVisible:d})]})},It=r(37306),ke=r.n(It),Pt=r(61122),Oe=r(5966),Qe=r(64317),at=r(52688),Ct=r(90672),Ft=r(31768),Bt=r(24739),nt=r(51198),Rt=function(e){var n,s,i,h=(0,t.useState)(),E=U()(h,2),l=E[0],d=E[1],P=(0,t.useRef)();(0,t.useEffect)(function(){var m;if(e.db!=null){var f=e.db;(0,nt.S5)(f.sourceName,f.name).then(function(p){d(p.data)}),(m=P.current)===null||m===void 0||m.resetFields()}},[e.db,e.visible]);var L={},A=ke()((l==null?void 0:l.tables)||[]),R;try{for(A.s();!(R=A.n()).done;){var O=R.value;L[O]=O}}catch(m){A.e(m)}finally{A.f()}var T=e.partitions.map(function(m){return"".concat(m.tableName,".").concat(m.value)}).join(`
`);return(0,a.jsxs)(Pt.Y,{title:"\u65B0\u5EFA\u8FC1\u79FB\u4EFB\u52A1",visible:e.visible,onVisibleChange:e.setVisible,layout:"horizontal",grid:!0,labelCol:{span:3},labelAlign:"left",formRef:P,onFinish:function(){var m=se()(J().mark(function f(p){var y,b,D,c;return J().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:y={},Object.assign(y,p),b="table_mapping",b in y&&(D=Lt(y[b],"srcTable","dstTable"),Object.keys(D).length>0?y[b]=D:delete y[b]),y.type="partitions",y.increment=!1,y.partitions=e.partitions.map(function(u){return u.id}),c=te.ZP.loading("\u63D0\u4EA4\u8FC1\u79FB\u4EFB\u52A1\u4E2D..."),(0,nt.p1)(y).then(function(u){if(u.success){e.setVisible(!1);return}(0,Le.oc)(u)}).catch(function(u){var M=u.response.data;te.ZP.error(M.message,10)}).finally(function(){c()});case 9:case"end":return g.stop()}},f)}));return function(f){return m.apply(this,arguments)}}(),children:[(0,a.jsx)(Oe.Z,{name:"description",label:"\u540D\u79F0:",placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",initialValue:"".concat((n=e.db)===null||n===void 0?void 0:n.name,"@").concat((0,Le.je)()),rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0"}]}),(0,a.jsx)(Oe.Z,{name:"source_name",label:"\u6570\u636E\u6E90:",placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",initialValue:(s=e.db)===null||s===void 0?void 0:s.sourceName,disabled:!0}),(0,a.jsx)(Oe.Z,{name:"db_name",label:"\u5E93\u540D:",placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",initialValue:(i=e.db)===null||i===void 0?void 0:i.name,disabled:!0}),(0,a.jsx)(Qe.Z,{colProps:{span:24},label:"\u4EFB\u52A1\u7C7B\u578B:",name:"task_type",initialValue:l==null?void 0:l.defaultTaskType,valueEnum:l==null?void 0:l.taskTypes,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4EFB\u52A1\u7C7B\u578B"}]}),(0,a.jsx)(Qe.Z,{colProps:{span:24},label:"mc\u9879\u76EE:",name:"dst_mc_project",valueEnum:function(){var m={},f=ke()((l==null?void 0:l.dstMcProjects)||[]),p;try{for(f.s();!(p=f.n()).done;){var y=p.value;m[y]=y}}catch(b){f.e(b)}finally{f.f()}return m}(),rules:[{required:!0,message:"\u8BF7\u9009\u62E9mc\u9879\u76EE"}]}),(0,a.jsx)(at.Z,{colProps:{span:24},initialValue:!0,label:"\u5F00\u542F\u6821\u9A8C",name:"enable_verification"}),(0,a.jsx)(at.Z,{colProps:{span:24},initialValue:!1,label:"\u53EA\u8FC1schema",name:"schema_only"}),(0,a.jsx)(Ct.Z,{name:"ptValues",label:"partition\u5217\u8868",initialValue:T,disabled:!0}),(0,a.jsx)(Ft.u,{name:"table_mapping",label:"\u8868\u540D\u6620\u5C04",children:(0,a.jsxs)(Bt.UW,{children:[(0,a.jsx)(Qe.Z,{showSearch:!0,name:"srcTable",valueEnum:L,colProps:{span:10},placeholder:"\u8BF7\u8F93\u5165\u6E90\u8868"}),(0,a.jsx)(Oe.Z,{name:"dstTable",colProps:{span:10},placeholder:"\u8BF7\u8F93\u5165\u76EE\u7684\u8868"})]},"group")})]})};function Lt(o,e,n){var s=o.filter(function(d){return e in d&&n in d}),i={},h=ke()(s),E;try{for(h.s();!(E=h.n()).done;){var l=E.value;i[l[e]]=l[n]}}catch(d){h.e(d)}finally{h.f()}return i}var At=function(o){var e=(0,t.useState)(0),n=U()(e,2),s=n[0],i=n[1],h=(0,t.useState)([]),E=U()(h,2),l=E[0],d=E[1],P=(0,t.useState)(!1),L=U()(P,2),A=L[0],R=L[1],O=[{title:"\u8868\u540D",dataIndex:"tableName"},{title:"\u5206\u533A\u503C",dataIndex:"value"},{title:"\u5927\u5C0F",dataIndex:"size",render:function(m,f){return f.size===void 0||f.size===0?"--":(0,Le.BU)(f.size)},search:!1,sorter:{compare:function(m,f){return 0},multiple:2}},{title:"\u884C\u6570",dataIndex:"numRows",render:function(m,f){return f.numRows===void 0||f.numRows===0?"--":f.numRows},search:!1,sorter:{compare:function(m,f){return 0},multiple:1}},{title:"\u5143\u6570\u636E\u6709\u66F4\u65B0",dataIndex:"updated",render:function(m,f){return f.updated?"\u662F":"\u5426"},valueType:"select",valueEnum:{0:{text:"\u5426"},1:{text:"\u662F"}}},{title:"\u6570\u636E\u6700\u540E\u4FEE\u6539\u65F6\u95F4",render:function(m,f){return f.lastDdlTime},dataIndex:"lastDdlTime",valueType:"dateRange",sorter:{compare:function(m,f){return 0},multiple:1}},{title:"\u72B6\u6001",dataIndex:"status",valueType:"checkbox",valueEnum:{INIT:{text:"\u672A\u8FC1\u79FB"},DONE:{text:"\u5B8C\u6210"},DOING:{text:"\u8FC1\u79FB\u4E2D"},FAILED:{text:"\u5931\u8D25"}},filters:!1}];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(he.Z,{columns:O,request:function(){var T=se()(J().mark(function m(f,p,y){var b;return J().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return f.dbId=o==null?void 0:o.db.id,c.next=3,(0,He.Xn)(f,p,y);case 3:return b=c.sent,i((b==null?void 0:b.total)||0),c.abrupt("return",b);case 6:case"end":return c.stop()}},m)}));return function(m,f,p){return T.apply(this,arguments)}}(),rowKey:"id",pagination:{showQuickJumper:!0,size:"default",responsive:!0,totalBoundaryShowSizeChanger:10,total:s},search:{filterType:"light"},rowSelection:{selections:[Ae.Z.SELECTION_ALL,Ae.Z.SELECTION_INVERT],onChange:function(m,f,p){d(f)}},toolbar:{actions:[(0,a.jsx)(Ge.Z,{type:"primary",onClick:function(){R(!0)},children:"\u65B0\u5EFA\u8FC1\u79FB\u4EFB\u52A1"},"2")]}}),(0,a.jsx)(Rt,{db:o.db,visible:A,setVisible:R,partitions:l})]})},Ot=function(o){var e=(0,t.useState)("tables"),n=U()(e,2),s=n[0],i=n[1],h=(0,t.useState)(),E=U()(h,2),l=E[0],d=E[1],P=new URLSearchParams(window.location.search),L=parseInt(P.get("dbId")||""),A=function(){(0,He.Ui)({id:L}).then(function(T){var m=T.data,f=m[0];d(f)})};(0,t.useEffect)(function(){A()},[L]);var R=function(T){var m=T==null?void 0:T.db;return m===void 0?(0,a.jsx)("div",{children:"\u52A0\u8F7D\u4E0D\u5230\u6570\u636E"}):T.tabKey=="tables"?(0,a.jsx)(Dt,{db:m}):(0,a.jsx)(At,{db:m})};return(0,a.jsx)(ze._z,{header:{title:l==null?void 0:l.name},tabList:[{tab:"table\u5217\u8868",key:"tables"},{tab:"partition\u5217\u8868",key:"partitions"}],onTabChange:function(T){i(T)},content:(0,a.jsxs)(_.Z,{column:3,children:[(0,a.jsx)(_.Z.Item,{label:"\u6570\u636E\u6E90",children:l==null?void 0:l.sourceName}),(0,a.jsx)(_.Z.Item,{label:"\u8868\u603B\u6570",children:l==null?void 0:l.tables}),(0,a.jsx)(_.Z.Item,{label:"\u8FC1\u79FB\u5B8C\u6210\u7684\u8868",children:l==null?void 0:l.tablesDone}),(0,a.jsx)(_.Z.Item,{label:"\u8FC1\u79FB\u4E2D\u7684\u8868",children:l==null?void 0:l.tablesDoing}),(0,a.jsx)(_.Z.Item,{label:"\u8FC1\u79FB\u5931\u8D25\u7684\u8868",children:l==null?void 0:l.tablesFailed}),(0,a.jsx)(_.Z.Item,{label:"\u5206\u533A\u603B\u6570",children:l==null?void 0:l.partitions}),(0,a.jsx)(_.Z.Item,{label:"\u8FC1\u79FB\u5B8C\u6210\u7684\u5206\u533A",children:l==null?void 0:l.partitionsDone}),(0,a.jsx)(_.Z.Item,{label:"\u8FC1\u79FB\u4E2D\u7684\u5206\u533A",children:l==null?void 0:l.partitionsDoing}),(0,a.jsx)(_.Z.Item,{label:"\u8FC1\u79FB\u5931\u8D25\u7684\u5206\u533A",children:l==null?void 0:l.partitionsFailed})]}),extra:[(0,a.jsx)(Ge.Z,{onClick:A,children:"\u5237\u65B0"},"updatePage")],children:(0,a.jsx)(R,{tabKey:s,db:l})})}}}]);
