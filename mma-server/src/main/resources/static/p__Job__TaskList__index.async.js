"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[186],{87969:function($,y,e){e.d(y,{b:function(){return U}});var B=e(37306),R=e.n(B),g=e(66933),b=e.n(g),D=e(62435),p=e(81701),Z=e(64317),d=e(86074),U=function(K){var C=(0,D.useState)({}),l=b()(C,2),n=l[0],T=l[1];return(0,D.useEffect)(function(){(0,p.BO)().then(function(o){var E={},s=R()((o==null?void 0:o.data)||[]),v;try{for(s.s();!(v=s.n()).done;){var f=v.value;E[f]=f}}catch(O){s.e(O)}finally{s.f()}T(E)})},[]),(0,d.jsx)(Z.Z,{showSearch:!0,name:K.keyName,valueEnum:n})}},37245:function($,y,e){e.d(y,{a:function(){return W},e:function(){return U}});var B=e(37306),R=e.n(B),g=e(66933),b=e.n(g),D=e(62435),p=e(8836),Z=e(64317),d=e(86074),U=function(){var C=(0,D.useState)({}),l=b()(C,2),n=l[0],T=l[1];return(0,D.useEffect)(function(){(0,p.e6)().then(function(o){var E={},s=R()((o==null?void 0:o.data)||[]),v;try{for(s.s();!(v=s.n()).done;){var f=v.value;E[f.id]={text:f.name}}}catch(O){s.e(O)}finally{s.f()}T(E)})},[]),(0,d.jsx)(Z.Z,{showSearch:!0,name:"sourceId",valueEnum:n})},W=function(){var C=(0,D.useState)({}),l=b()(C,2),n=l[0],T=l[1];return(0,D.useEffect)(function(){(0,p.e6)().then(function(o){var E={},s=R()((o==null?void 0:o.data)||[]),v;try{for(s.s();!(v=s.n()).done;){var f=v.value;E[f.name]={text:f.name}}}catch(O){s.e(O)}finally{s.f()}T(E)})},[]),(0,d.jsx)(Z.Z,{showSearch:!0,name:"sourceName",valueEnum:n})}},5265:function($,y,e){e.r(y),e.d(y,{default:function(){return me}});var B=e(37306),R=e.n(B),g=e(29883),b=e.n(g),D=e(54332),p=e.n(D),Z=e(66933),d=e.n(Z),U=e(94043),W=e.n(U),K=e(85067),C=e(15999),l=e(51198),n=e(62435),T=e(51752),o=e(79166),E=e(25084),s={INIT:{text:"\u672A\u6267\u884C"},RUNNING:{text:"\u6B63\u5728\u8FD0\u884C"},DONE:{text:"\u6210\u529F"},STOPPED:{text:"\u505C\u6B62"},FAILED:{text:"\u5931\u8D25"},SCHEMA_DOING:{text:"\u8FC1\u79FBschema\u4E2D"},SCHEMA_DONE:{text:"\u8FC1\u79FBschema\u6210\u529F"},SCHEMA_FAILED:{text:"\u8FC1\u79FBschema\u5931\u8D25"},DATA_DOING:{text:"\u8FC1\u79FB\u6570\u636E\u4E2D"},DATA_DONE:{text:"\u8FC1\u79FB\u6570\u636E\u6210\u529F"},DATA_FAILED:{text:"\u8FC1\u79FB\u6570\u636E\u5931\u8D25"},VERIFICATION_DOING:{text:"\u6821\u9A8C\u6570\u636E\u4E2D"},VERIFICATION_DONE:{text:"\u6821\u9A8C\u6570\u636E\u6210\u529F"},VERIFICATION_FAILED:{text:"\u6821\u9A8C\u6570\u636E\u5931\u8D25"}},v={INIT:"default",SCHEMA_DOING:"processing",SCHEMA_DONE:"processing",SCHEMA_FAILED:"error",DATA_DOING:"processing",DATA_DONE:"processing",DATA_FAILED:"error",VERIFICATION_DOING:"processing",VERIFICATION_DONE:"processing",VERIFICATION_FAILED:"error",DONE:"success"},f=e(48086),O=e(37636),H=e(71230),h=e(15746),t=e(86074),ee=function(j){var P=(0,n.useState)([]),A=d()(P,2),F=A[0],m=A[1],x=function(){(0,l.b4)(j.task.id).then(function(G){m(G.data||[])}).catch(function(){f.ZP.error("\u52A0\u8F7D\u5B50\u4EFB\u52A1log\u5931\u8D25",5)})};(0,n.useEffect)(function(){x();var r=setInterval(x,2e3);return function(){clearInterval(r)}},[j]);var i=F.map(function(r){return(0,t.jsxs)(O.Z.Item,{color:te[r.status],children:[(0,t.jsxs)(H.Z,{gutter:[0,5],children:[(0,t.jsx)(h.Z,{span:1,children:"\u65F6\u95F4:"}),(0,t.jsx)(h.Z,{children:r.createTime})]}),(0,t.jsxs)(H.Z,{children:[(0,t.jsx)(h.Z,{span:1,children:"\u72B6\u6001:"}),(0,t.jsx)(h.Z,{children:(0,t.jsx)(o.Z,{status:v[r.status],text:s[r.status].text})})]}),(0,t.jsxs)(H.Z,{children:[(0,t.jsx)(h.Z,{span:1,children:"\u52A8\u4F5C:"}),(0,t.jsx)(h.Z,{children:function(){return r!=null&&r.action.startsWith("http")?(0,t.jsx)("a",{href:r.action,children:r.action}):(r==null?void 0:r.action)||"--"}()})]}),(0,t.jsxs)(H.Z,{children:[(0,t.jsx)(h.Z,{span:1,children:"\u7ED3\u679C:"}),(0,t.jsx)(h.Z,{children:function(){return r!=null&&r.msg.startsWith("http")?(0,t.jsx)("a",{href:r.msg,target:"_blank",children:r.msg}):(r==null?void 0:r.msg)||"--"}()})]})]},r.id)});return(0,t.jsxs)(H.Z,{justify:i.length>0?"end":"",children:[(0,t.jsx)(h.Z,{children:i.length>0?(0,t.jsx)("a",{href:"/api/tasks/".concat(j.task.id,"/logs"),children:"\u4E0B\u8F7D\u65E5\u5FD7"}):""}),(0,t.jsx)(h.Z,{span:24,children:(0,t.jsx)(O.Z,{children:i.length>0?i:(0,t.jsx)("span",{children:"\u65E0\u6267\u884C\u65E5\u5FD7"})})})]})},te={INIT:"gray",SCHEMA_DOING:"green",SCHEMA_DONE:"green",SCHEMA_FAILED:"red",DATA_DOING:"green",DATA_DONE:"green",DATA_FAILED:"red",VERIFICATION_DOING:"green",VERIFICATION_DONE:"green",VERIFICATION_FAILED:"red",DONE:"green"},N=e(4914),ae=function(M){var j=(0,n.useState)([]),P=d()(j,2),A=P[0],F=P[1];(0,n.useEffect)(function(){(0,l.hU)(M.task.id).then(function(i){F((i==null?void 0:i.data)||[])}).catch(function(){f.ZP.error("\u52A0\u8F7D\u5B50\u4EFB\u52A1\u5206\u533A\u5931\u8D25",5)})},[M]);var m=M.task,x=A.map(function(i){return(0,t.jsxs)(t.Fragment,{children:[i.value," ",(0,t.jsx)("br",{})," "]})});return(0,t.jsxs)(N.Z,{title:"User Info",bordered:!0,column:2,children:[(0,t.jsx)(N.Z.Item,{label:"\u6570\u636E\u6E90",children:m.sourceName}),(0,t.jsx)(N.Z.Item,{label:"\u6E90\u6570\u636E\u5E93",children:m.dbName}),(0,t.jsx)(N.Z.Item,{label:"\u6E90\u8868",children:m.tableName}),(0,t.jsx)(N.Z.Item,{label:"\u76EE\u7684\u9879\u76EE",children:m.odpsProject}),(0,t.jsx)(N.Z.Item,{label:"\u76EE\u7684\u8868",children:m.odpsTable}),(0,t.jsx)(N.Z.Item,{label:"\u5206\u533A",children:x})]})},re=e(37245),ne=e(64317),se=function(j){var P=(0,n.useState)({}),A=d()(P,2),F=A[0],m=A[1];return(0,n.useEffect)(function(){(0,l.tM)().then(function(x){m((x==null?void 0:x.data)||[])})},[]),(0,t.jsx)(ne.Z,{showSearch:!0,name:"jobId",valueEnum:F,initialValue:j.initialValue})},ue=e(18036),oe=e(87969),le=["type","defaultRender"],de=["type","defaultRender"],ie=["type","defaultRender"],ce=["type","defaultRender"],Q=T.Z.TabPane,me=function(){var M=(0,n.useState)(0),j=d()(M,2),P=j[0],A=j[1],F=(0,n.useState)(!1),m=d()(F,2),x=m[0],i=m[1],r=(0,n.useState)(),G=d()(r,2),V=G[0],X=G[1],_e=(0,n.useState)(!1),Y=d()(_e,2),ve=Y[0],k=Y[1],fe=(0,ue.useSearchParams)(),w=d()(fe,2),Ie=w[0],De=w[1],Ee=(0,n.useRef)(),he=(0,n.useRef)(),J=Ie.get("jobId"),q={};(0,n.useEffect)(function(){(0,l.ru)().then(function(c){var u;q=(u=c.data)!==null&&u!==void 0?u:{}})});var je=[{title:"id",dataIndex:"id",search:!1},{title:"\u4EFB\u52A1\u540D",dataIndex:"jobName",key:"jobId",renderFormItem:function(u,a,I){var S=a.type,_=a.defaultRender,z=p()(a,le);return(0,t.jsx)(se,{initialValue:J||""})}},{title:"\u6570\u636E\u6E90",dataIndex:"sourceName",key:"sourceId",renderFormItem:function(u,a,I){var S=a.type,_=a.defaultRender,z=p()(a,de);return(0,t.jsx)(re.e,{})}},{title:"\u6E90\u6570\u636E\u5E93",dataIndex:"dbName"},{title:"\u6E90\u8868",dataIndex:"tableName"},{title:"\u76EE\u7684\u9879\u76EE",dataIndex:"odpsProject",renderFormItem:function(u,a,I){var S=a.type,_=a.defaultRender,z=p()(a,ie);return(0,t.jsx)(oe.b,{keyName:"odpsProject"})}},{title:"\u76EE\u7684\u8868",dataIndex:"odpsTable"},{title:"\u7C7B\u578B",dataIndex:"type",hideInSearch:!0},{title:"\u72B6\u6001",dataIndex:"status",render:function(u,a){return a.stopped?(0,t.jsx)(o.Z,{status:"warning",text:"\u505C\u6B62"}):(0,t.jsx)(o.Z,{status:v[a.status],text:s[a.status].text})},valueType:"select",valueEnum:s,sorter:{compare:function(u,a){return 0},multiple:2}},{title:"\u5F00\u59CB\u6267\u884C\u65F6\u95F4",dataIndex:"startTime",search:!1,sorter:{compare:function(u,a){return 0},multiple:1}},{title:"\u7ED3\u675F\u65F6\u95F4",dataIndex:"endTime",search:!1},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",search:!1},{title:"\u5206\u533A",key:"partition",hideInTable:!0,dataIndex:"partition",renderFormItem:function(u,a,I){var S=a.type,_=a.defaultRender,z=p()(a,ce);return ve?_(u):""}},{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",render:function(u,a){var I=[(0,t.jsx)("a",{onClick:function(){i(!0),X(a)},children:"\u8BE6\u60C5"},"1")];return I},search:!1}];return(0,t.jsxs)(K._z,{children:[(0,t.jsx)(C.Z,{actionRef:Ee,formRef:he,columns:je,request:function(){var c=b()(W().mark(function u(a,I,S){var _;return W().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return(a==null?void 0:a.tableName)!=null?k(!0):k(!1),J!=null&&(a.jobId=J),L.next=4,(0,l.Ak)(a,I,S);case 4:return _=L.sent,A((_==null?void 0:_.total)||0),L.abrupt("return",_);case 7:case"end":return L.stop()}},u)}));return function(u,a,I){return c.apply(this,arguments)}}(),postData:function(u){var a=R()(u),I;try{for(a.s();!(I=a.n()).done;){var S=I.value;S.type=q[S.type]}}catch(_){a.e(_)}finally{a.f()}return u},rowKey:"id",search:{filterType:"light"},pagination:{showQuickJumper:!0,size:"default",responsive:!0,totalBoundaryShowSizeChanger:10,total:P}}),(0,t.jsx)(E.Z,{width:1e3,visible:x,onClose:function(){X(void 0),i(!1)},closable:!1,children:(V==null?void 0:V.id)&&(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(T.Z,{defaultActiveKey:"1",children:[(0,t.jsx)(Q,{tab:"\u6267\u884C\u8FC7\u7A0B",children:(0,t.jsx)(ee,{task:V})},"1"),(0,t.jsx)(Q,{tab:"\u8FC1\u79FB\u7684\u8868/\u5206\u533A",children:(0,t.jsx)(ae,{task:V})},"2")]})})})]})},xe=null}}]);
